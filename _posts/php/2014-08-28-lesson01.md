---
layout: post
title:  "Введение в PHP"
date:   2014-08-28 11:36:40
published: true
---

<a id="toc"></a>

## Содержание

* [Необходимое ПО](#toc-soft)
* [Что такое PHP?](#toc-what-php)
* [Возможности PHP](#toc-abilities-php)
* [Руководство по установке PHP в Windows](#toc-install-php)
    * [Изменение файла php.ini](#toc-php.ini)
    * [Командная строка PHP в Microsoft Windows](#toc-command-line)
    * [Встроенный web-сервер](#toc-local-server)
* [Теги PHP](#toc-php-tags)
* [Разделение инструкций](#toc-php-statements)
* [Комментарии](#toc-php-comments)

## Необходимое ПО <a id="toc-soft" href="#toc">#Вверх</a>

1. 	Интерпретатор PHP 5.5 или 5.6 [[скачать]](http://windows.php.net/download/). 
	
	Прочитать [Руководство по установке PHP в Windows](#toc-install-php)

2. Любой браузер (Chrome, Firefox, Opera, IE)
3. Любой текстовый редактор или IDE (Sublime Text, Notepad++, NetBeans, PhpStorm или др.)
4. (не обязательно) Можно воспользоваться такими пакетами как [XAMPP](https://www.apachefriends.org/index.html), [WAMP](http://www.wampserver.com/en/) или аналогичными. Не рекомендуется использовать Denwer, так как эта сборка уже достаточно устарела.

## Что такое PHP? <a id="toc-what-php" href="#toc">#Вверх</a>

PHP (рекурсивный акроним словосочетания PHP: Hypertext Preprocessor) - это распространенный язык программирования общего назначения с открытым исходным кодом. PHP сконструирован специально для ведения Web-разработок и его код может внедряться непосредственно в HTML.

#### Пример #1 Пример программирования на PHP

{% highlight php %}
<!DOCTYPE html>
<html>
    <head>
        <title>Пример</title>
    </head>
    <body>
        <?php echo "Привет, я - скрипт PHP!"; ?>
    </body>
</html>
{% endhighlight %}

Вместо рутинного вывода HTML-кода командами языка (как это происходит, например, в Perl или C), скрипт PHP содержит HTML с вкраплениями кода (в нашем случае, это вывод текста "Привет, я - скрипт PHP!"). Код PHP отделяется специальными начальным и конечным тегами `<?php` и `?>`, которые позволяют "переключаться" в "PHP-режим" и выходить из него.

PHP отличается от JavaScript тем, что PHP-скрипты выполняются на сервере и генерируют HTML, который посылается клиенту. Если бы у вас на сервере был размещен скрипт, подобный вышеприведенному, клиент получил бы только результат его выполнения, но не смог бы выяснить, какой именно код его произвел. Вы даже можете настроить свой сервер таким образом, чтобы обычные HTML-файлы обрабатывались процессором PHP, так что клиенты даже не смогут узнать, получают ли они обычный HTML-файл или результат выполнения скрипта.


## Возможности PHP <a id="toc-abilities-php" href="#toc">#Вверх</a>

Главная область применения PHP - написание скриптов, работающих на стороне сервера; таким образом, PHP способен выполнять все то, что выполняет любая другая программа CGI, например, обрабатывать данные форм, генерировать динамические страницы или отсылать и принимать cookies.

Существуют три основных области применения PHP:

- Создание скриптов для выполнения на стороне сервера. PHP традиционно и наиболее широко используется именно таким образом. Для этого вам будут необходимы три вещи. Интерпретатор PHP (в виде программы CGI или серверного модуля), веб-сервер и браузер.

- Создание скриптов для выполнения в командной строке. Вы можете создать PHP-скрипт, способный запускаться без сервера или браузера. Все, что вам потребуется - интерпретатор PHP. Такой способ использования PHP идеально подходит для скриптов, которые должны выполняться регулярно, например, с помощью cron (на платформах *nix или Linux) или с помощью планировщика задач (Task Scheduler) на платформах Windows.

- Создание оконных приложений, выполняющихся на стороне клиента. Возможно, PHP является не самым лучшим языком для создания подобных приложений, но, если вы очень хорошо знаете PHP и хотели бы использовать некоторые его возможности в своих клиентских приложениях, вы можете использовать PHP-GTK для создания таких приложений.

PHP доступен для большинства операционных систем, включая Linux, многие модификации Unix (такие как HP-UX, Solaris и OpenBSD), Microsoft Windows, Mac OS X, RISC OS, и многие другие. Также в PHP включена поддержка большинства современных веб-серверов, таких как Apache, IIS и многих других. В принципе, подойдет любой веб-сервер, способный использовать бинарный файл FastCGI PHP, например, lighttpd или nginx. PHP может работать в качестве модуля или функционировать в качестве процессора CGI.

## Руководство по установке PHP в Windows <a id="toc-install-php" href="#toc">#Вверх</a>

Загрузите дистрибутив PHP в виде zip-архива с [PHP для Windows: Исполняемые файлы и исходные коды](http://windows.php.net/download/).

- Загрузите последнюю стабильную версию **5.5** или **5.6** (**VC11 x86 Thread Safe**), если используется Windows 7 или 8. Также необходимо установить [Visual C++ Redistributable for Visual Studio 2012 x86](http://www.microsoft.com/en-us/download/details.aspx?id=30679)

- Используйте версию 5.4 или 5.3 (VC9 x86 Thread Safe) на Windows XP. Также необходимо установить [Visual C++ Redistributable for Visual Studio 2008 SP1](http://www.microsoft.com/en-us/download/details.aspx?id=5582)

Распакуйте содержимое zip архива в директорию по вашему выбору, например `C:\bin\php-5.5`. 

### Изменение файла php.ini <a id="toc-php.ini" href="#toc">#Вверх</a>

После того, как содержимое пакета php извлечено, создайте копию `php.ini-production` с именем `php.ini` в той же папке. Файл `php.ini` содержит правила исполнения PHP и инструкции по работе с окружением, в котором он запускается. Ниже приводятся некоторые из настроек `php.ini`.

- `extension_dir = <путь к директории расширений>` - `extension_dir` указывает директорию, где расположены расширения PHP. Путь может быть абсолютым (например "C:\PHP\ext") или относительным (например ".\ext"). Используемые в `php.ini` расширения должны быть расположены в `extension_dir`.

- `extension = xxxxx.dll` - Для каждого подключаемого расширения необходимо указать директиву "extension=". Расширения из `extension_dir`, отмеченные такой директивой, загружаются при старте PHP.

- `log_errors = On` - в PHP есть механизм ведения лога ошибок, который может использоваться для сохранения ошибок в файле.

- `error_log = <пусть к файлу лога ошибок>` - error_log нужен для обозначения абсолютного или относительного пути к файлу, в который протоколируются ошибки PHP. Этот файл должен доступным для записи веб-сервером. Самые распространенные места размещения этого файла - различные временные TEMP директории.

- `max_execution_time = ##` - Эта директива указывает максимальное время выполнения любого скрипта PHP. По умолчанию равно 30 секундам. Следует увеличить это значение, если приложение PHP должно выполняться дольше.

- `memory_limit = ###M` - Количество памяти, доступное процессу PHP, в Мб. По умолчанию 128, что достаточно для большинства PHP приложений. Некоторым сложным приложениям может потребоваться больше памяти.

- `display_errors = Off` - Директива определяет, какие ошибки следует возвращать веб-серверу для дальнейшего протоколирования. При значении "On" PHP сообщает обо всех видах ошибок, которые приводятся в директиве error_reporting. По соображениям безопасности рекомендуется установить в "Off" на рабочих серверах, чтобы исключить передачу вывода ошибкок конечному пользователю, так как они могут содержат информацию, угрожающую безопасности приложения.

- `upload_max_filesize = ###M` и `post_max_size = ###M` - Максимальный разрешенный размер загруженного файла и присланных данных соответственно. Значения этих директив должны быть увеличены, если приложения PHP должны обрабатывать большие загружаемые файлы, например изображения или видеофайлы.

### Командная строка PHP в Microsoft Windows <a id="toc-command-line" href="#toc">#Вверх</a>

PHP, запущенный из командной строки, может выполняться без каких-либо изменений в Windows.

```
C:\PHP5\php.exe -f "C:\PHP Scripts\script.php" -- -arg1 -arg2 -arg3
```

Допишите расположение исполняемых файлов php (php.exe, php-win.exe или php-cli.exe в зависимости от ваших предпочтений и версии PHP) в конец переменной окружения `PATH` для запуска php из любой директории.

### Встроенный web-сервер <a id="toc-local-server" href="#toc">#Вверх</a>

Начиная с версии PHP 5.4.0 модуль CLI SAPI содержит встроенный web-сервер.

Этот web-сервер предназначен для использования при разработке и не должен использоваться на обычном сервере.

Запросы обслуживаются последовательно.

#### Пример #1 Запуск web-сервера

```
php -S localhost:8000
```

#### Пример #2 Запуск с указанием корневой директории

```
php -S localhost:8000 -t foo/
```

#### Пример #3 Запуск локального web-сервера из проводника через меню `Отправить`

Создайте файл `phpserver.bat` с содержимым

{% highlight batch %}
explorer http://localhost:8888
if exist "%~1\" (
  php -S localhost:8888 -t "%~1"
) else (
  php -S localhost:8888 -t "%~dp1"
)
{% endhighlight %}

Потом выполните команду `shell:sendto` и создайте ярлык на файл `phpserver.bat`. 

## Теги PHP <a id="toc-php-tags" href="#toc">#Вверх</a>

Когда PHP обрабатывает файл, он ищет открывающие и закрывающие теги, такие как `<?php` и `?>`, которые указывают PHP, когда начинать и заканчивать обработку кода между ними. Подобный способ обработки позволяет PHP внедряться во все виды различных документов, так как всё, что находится вне пары открывающих и закрывающих тегов, будет проигнорировано парсером PHP.

PHP также допускает короткие теги `<?` и `?>`, однако использовать их нежелательно, так как они доступны только если включены с помощью конфигурационной директивы php.ini short_open_tag, либо если PHP был сконфигурирован с опцией --enable-short-tags .

Если файл содержит только код PHP, предпочтительно опустить закрывающий тег в конце файла. Это помогает избежать добавлени случайных символов пробела или перевода строки после закрывающего тега PHP, которые могут послужить причиной нежелательных эффектов, так как PHP начинает выводить данные в буфер при отсутствии намерения у программиста выводить какие-либо данные в этой точке скрипта.

{% highlight php %}
<?php
echo "Hello world";

// ... еще код

echo "Последнее выражение";

// Скрипт заканчивается тут без закрывающего тега PHP
{% endhighlight %}

#### Пример #2 Открывающие и закрывающие теги PHP

{% highlight php %}
1.  <?php echo 'если вы хотите работать с документами XHTML или XML, делайте так'; ?>

2.  <script language="php">
        echo 'некоторые редакторы (например, FrontPage) не
              любят инструкции обработки';
    </script>

3.  <? echo 'это простейшая инструкция обработки SGML'; ?>
    <?= выражение ?> Это синоним для "<? echo выражение ?>"

4.  <% echo 'Вы можете по выбору использовать теги в стиле ASP'; %>
    <%= $variable; # Это синоним для "<% echo . . ." %>
{% endhighlight %}

Начиная с **PHP 5.4** короткий тег echo `<?=` всегда распознается и действует, несмотря на значение опции `short_open_tag`.

## Разделение инструкций <a id="toc-php-statements" href="#toc">#Вверх</a>

PHP требует окончания инструкций точкой запятой в конце каждой инструкции. Закрывающий тег блока PHP-кода автоматически применяет точку с запятой; т.е. нет необходимости ставить точку с запятой в конце последней строки блока с PHP-кодом. Закрывающий тег блока "поглотит" немедленно следующий за ним переход на новую строку, если таковой будет обнаружен.

{% highlight php %}
<?php
    echo 'Это тест';
?>

<?php echo 'Это тест' ?>

<?php echo 'Мы опустили последний закрывающий тег';
{% endhighlight %}

## Комментарии <a id="toc-php-comments" href="#toc">#Вверх</a>

PHP поддерживает комментарии в стиле 'C', 'C++' и оболочки Unix (стиль Perl). Например:

{% highlight php %}
<?php
    echo "Это тест"; // Это однострочный комментарий в стиле c++
    /* Это многострочный комментарий
       еще одна строка комментария */
    echo "Это еще один тест";
    echo "Последний тест"; # Это комментарий в стиле оболочки Unix
?>
{% endhighlight %}

Однострочные комментарии идут только до конца строки или текущего блока PHP-кода, в зависимости от того, что идет перед ними. Это означает, что HTML-код после // ... ?> или # ... ?> БУДЕТ напечатан: ?> завершает режим PHP и возвращает режим HTML, а // или # не могут повлиять на это. Если включена директива asp_tags, то аналогичное поведение будет и с // %> и # %>. Однако, тег </script> не завершает режим PHP в однострочном комментарии.

{% highlight php %}
<h1>Это <?php # echo "простой";?> пример</h1>
<p>Заголовок вверху выведет 'Это пример'.</p>
{% endhighlight %}

'C'-комментарии заканчиваются при первой же обнаруженной последовательности */. Убедитесь, что вы не вкладываете друг в друга 'C'-комментарии. Очень легко допустить эту ошибку при комментировании большого блока кода.

{% highlight php %}
<?php
 /*
    echo "Это тест"; /* Этот комментарий вызовет проблему */
 */
?>
{% endhighlight %}